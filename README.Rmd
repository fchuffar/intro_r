---
title: "R introduction"
author: "Florent Chuffart"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
---



# R Software


## GNU Public Licence

R is a free software environment for statistical computing and graphics.

More details about GNU, GPL and free software here:

  - https://www.gnu.org/philosophy/free-sw.html
  - https://en.wikipedia.org/wiki/GNU_General_Public_License
  - https://en.wikipedia.org/wiki/Free_software_movement
  - https://en.wikipedia.org/wiki/CeCILL

## R and biology

R is widely is in the life science communauty:

  - https://www.ncbi.nlm.nih.gov/pubmed/?term=r+software

## R Communauty

Many packages are freely available on:

  - CRAN https://cran.r-project.org
  - Bioconductor https://www.bioconductor.org
  - GitHub https://github.com

R users is organise as a communauty with many helps topics available on the internet.



# R CLI vs. GUI

## CLI

R could be compared to an electronic calculator. It provides not only basic operations but also advanced features allowing to manipulate distributions and visualize data.

```{r}
1+1
pi
rnorm(100)
plot(density(rnorm(100)))
```


## R GUI (RStudio) ***

https://www.rstudio.com

# Let's strat with R!

## working directory
```{r, eval=FALSE}
getwd()
# ?getwd()
# ?setwd()
```

## From a spreadsheet to R data.frame ***

```{r}
data_sh = read.table("data/seahorse_dataset2.csv", sep=";", header=TRUE, dec=".")
head(data_sh)
tail(data_sh)
dim(data_sh)
summary(data_sh)

data_sh[1,]
data_sh[,1]

```


# Data 

## Affectation

```{r}
foo <- 1
foo

bar = "a"
bar

"b" -> baz
baz

quz <<- baz
```

## Common types

- numeric
- factor
- character
- logical (boolean)


```{r}
TRUE
T
T = 3
T
# TRUE = 3

is.logical("true")
is.character("true")
other_var = as.logical("true")
other_var

as.character(TRUE)
as.numeric(TRUE)
as.numeric(FALSE)
as.logical(1)
as.logical(0)



col_y = c("bleu", "bleu", "vert", "marron", "vert", "marron") 
col_y

as.factor(col_y)

```


## set of data

|    | Homogeneous | Heterogeneous |
|----|-------------|---------------|
| 1d |  vector     | list          |
| 2d |  matrix     | data.frame    |


```{r}
1:5
c(1,2,10)
c(1,"a",10)
c(TRUE,0)
v = rnorm(100)
v[c(5,18,39)]
v[98:100]

list(1,"a",10)
l = list(chr="8", tx_start=124330091, tx_end=124410705, gs="ATAD2", ref="hg19", strand="-")
l
c(tx_start=124330091, tx_end=124410705)

m = matrix(runif(120),20)
m
m[20,6]
m[19:20,5:6]
m[c(17,20),]
m[,c(TRUE, FALSE, TRUE, FALSE, TRUE, FALSE)]


data = data.frame(size=rnorm(25)+175, gender=sample(c("M", "F"), 25, replace=TRUE))
data[1:5,]
head(data)
data$gender



data[data$gender=="M",]
data[data$gender=="M" & data$size > 170,]

factor(sample(c("10", "J", "Q", "K", "A"), 25, replace=TRUE))
factor(sample(c("10", "J", "Q", "K", "A"), 25, replace=TRUE), levels=c("10", "J", "Q", "K", "A"), ordered=TRUE)
```


## Selecting lines and columns of a dataset ***

```{r}
v = 100:130
v
v[1]
v[-1]
rev(v)[1]
v[1:4]
# index by the rank
v[c(1, 4, 10, 15)]
# index by mask
col_y
col_y[c(TRUE,FALSE, TRUE, TRUE, FALSE, TRUE)]

## select a column
# by name
data_sh$id
# by rank
data_sh[,2]
data_sh[,2:6]
data_sh[,7:11]
(data_sh[,7:11]/data_sh[,2:6])
data_sh[,c(FALSE,TRUE,TRUE,TRUE,TRUE,TRUE,FALSE,FALSE, FALSE,FALSE,FALSE)]
## select a line
data_sh[1,]
# both
ctrl_j1 = data_sh[1:2,2:6]
case_j1 = data_sh[1:2,7:11]
# normalization
data_sh_norm_j1 = case_j1/ctrl_j1
data_sh_norm_j1

data_sh
for (i in 2:11) {
  if (i > 4) {
    print("It works!!")
    print(i)
  }
  print(mean(data_sh[,i], na.rm = TRUE))
}

a = 5
if (a > 4) {
  print("It works!!")
}

```








# To go further with R

## scripts

```{r, eval=FALSE}
source("intro_r.R")
```



## functions

### Common functions

```{r}
x = c(1,2,3,4,5)
y = c(2,4,6,8,10)
length(x)
plot(x,y)

rnd = runif(100000)
dices = round(rnd * 6)
table(dices)
barplot(table(dices))
dices = floor(rnd * 6)
barplot(table(dices))
dices = ceiling(rnd * 6)
barplot(table(dices))
pie(table(dices))

mat_5_dices = matrix(dices,5)
dim(mat_5_dices)
mat_5_dices[,1:10]

sum_5_dices = apply(mat_5_dices, 2, sum)
table(sum_5_dices)
barplot(table(sum_5_dices))


prop.table(table(sum_5_dices))
prop.table(table(sum_5_dices))
sum(prop.table(table(sum_5_dices)))
```

```{r, eval=FALSE}
?ls()
?paste()

?sum()    
?cumsum() 
?sqrt()   

?rnorm()
?qnorm()
?pnorm()

?cbind()
?rbind()

?sort()
?order()
?grep()

?read.table()
?write.table()

```

### Custom functions

  - signature (parameter)
  - return
  - scope and global variables
  

```{r}

hello_world = function(name="world") {
  ret = paste("Hello ", name, "!", sep="")
  return(ret)  
}

hello_world()

```




  


 

## control structure

A control structure is a block of programming that analyzes variables and chooses a direction in which to go based on given parameters.
  


## algorithm

  An algorithm is a self-contained sequence of actions to be performed. 
  An algorithm is an effective method that can be expressed within a finite amount of space and time.

# Refrences


http://adv-r.had.co.nz

http://r-pkgs.had.co.nz

# exercices 

http://graal.ens-lyon.fr/~fchuffart/files/data/exercices.pdf
